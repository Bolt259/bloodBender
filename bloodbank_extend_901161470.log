2025-10-13 21:01:27,425 - __main__ - INFO - Initialized TandemHistoricalSyncClient
2025-10-13 21:01:27,425 - __main__ - INFO - Output directory: bloodBath/bloodBank/raw
2025-10-13 21:01:27,426 - __main__ - INFO - Chunk size: 30 days
2025-10-13 21:01:27,426 - __main__ - INFO - Starting sync for 1 pump(s)
2025-10-13 21:01:27,426 - __main__ - INFO - Starting sync for pump 901161470
2025-10-13 21:01:27,427 - __main__ - INFO - Generated 9 date chunks for pump 901161470
2025-10-13 21:01:27,427 - __main__ - INFO - Processing chunk 1/9: 2025-02-01 to 2025-03-03
2025-10-13 21:01:27,427 - __main__ - INFO - Connecting to Tandem API (US region)...
2025-10-13 21:01:27,427 - __main__ - INFO - API connection established
2025-10-13 21:01:27,427 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:01:27,428 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (27 min 32 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 2 min 27 sec)
2025-10-13 21:01:27,428 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:01:28,194 - __main__ - INFO - Fetching data for pump 901161470: 2025-02-01 to 2025-03-03
2025-10-13 21:01:29,195 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:01:29,195 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (27 min 33 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 2 min 25 sec)
2025-10-13 21:01:29,195 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:01:33,378 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:01:33,379 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (27 min 38 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 2 min 21 sec)
2025-10-13 21:01:33,379 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:01:37,510 - tconnectsync.api.tandemsource - INFO - Read 3214640 bytes (est. 123640.0 events)
2025-10-13 21:01:41,586 - __main__ - INFO - Successfully fetched 8937 records for pump 901161470
2025-10-13 21:01:41,706 - __main__ - INFO - ✅ Saved 8937 records to bloodBath/bloodBank/raw/pump_901161470/2025-02-01_to_2025-03-03.csv with v2.0 header
2025-10-13 21:01:42,304 - __main__ - INFO - Processing chunk 2/9: 2025-03-03 to 2025-04-02
2025-10-13 21:01:42,304 - __main__ - INFO - Fetching data for pump 901161470: 2025-03-03 to 2025-04-02
2025-10-13 21:01:44,364 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:01:44,365 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (27 min 49 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 2 min 10 sec)
2025-10-13 21:01:44,365 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:01:49,293 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:01:49,294 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (27 min 54 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 2 min 5 sec)
2025-10-13 21:01:49,294 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:02:18,139 - tconnectsync.api.tandemsource - INFO - Read 3159624 bytes (est. 121524.0 events)
2025-10-13 21:02:22,113 - __main__ - INFO - Successfully fetched 8932 records for pump 901161470
2025-10-13 21:02:22,231 - __main__ - INFO - ✅ Saved 8932 records to bloodBath/bloodBank/raw/pump_901161470/2025-03-03_to_2025-04-02.csv with v2.0 header
2025-10-13 21:02:22,826 - __main__ - INFO - Processing chunk 3/9: 2025-04-02 to 2025-05-02
2025-10-13 21:02:22,826 - __main__ - INFO - Fetching data for pump 901161470: 2025-04-02 to 2025-05-02
2025-10-13 21:02:23,827 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:02:23,827 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (28 min 28 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 1 min 31 sec)
2025-10-13 21:02:23,828 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:02:27,730 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:02:27,731 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (28 min 32 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 1 min 27 sec)
2025-10-13 21:02:27,731 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:02:31,737 - tconnectsync.api.tandemsource - INFO - Read 3197558 bytes (est. 122983.0 events)
2025-10-13 21:02:35,729 - __main__ - INFO - Successfully fetched 8932 records for pump 901161470
2025-10-13 21:02:35,843 - __main__ - INFO - ✅ Saved 8932 records to bloodBath/bloodBank/raw/pump_901161470/2025-04-02_to_2025-05-02.csv with v2.0 header
2025-10-13 21:02:36,437 - __main__ - INFO - Processing chunk 4/9: 2025-05-02 to 2025-06-01
2025-10-13 21:02:36,437 - __main__ - INFO - Fetching data for pump 901161470: 2025-05-02 to 2025-06-01
2025-10-13 21:02:37,439 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:02:37,439 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (28 min 42 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 1 min 17 sec)
2025-10-13 21:02:37,439 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:02:41,033 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:02:41,034 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (28 min 45 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 1 min 13 sec)
2025-10-13 21:02:41,034 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:02:44,728 - tconnectsync.api.tandemsource - INFO - Read 3066180 bytes (est. 117930.0 events)
2025-10-13 21:02:48,766 - __main__ - INFO - Successfully fetched 8945 records for pump 901161470
2025-10-13 21:02:48,877 - __main__ - INFO - ✅ Saved 8945 records to bloodBath/bloodBank/raw/pump_901161470/2025-05-02_to_2025-06-01.csv with v2.0 header
2025-10-13 21:02:50,529 - __main__ - INFO - Processing chunk 5/9: 2025-06-01 to 2025-07-01
2025-10-13 21:02:50,529 - __main__ - INFO - Fetching data for pump 901161470: 2025-06-01 to 2025-07-01
2025-10-13 21:02:51,530 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:02:51,531 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (28 min 56 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 1 min 3 sec)
2025-10-13 21:02:51,531 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:02:55,388 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:02:55,389 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min ago), access token expiry 2025-10-14T04:03:55+00:00 (in 59 sec)
2025-10-13 21:02:55,389 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:00,222 - tconnectsync.api.tandemsource - INFO - Read 3066882 bytes (est. 117957.0 events)
2025-10-13 21:03:04,240 - __main__ - INFO - Successfully fetched 8939 records for pump 901161470
2025-10-13 21:03:04,355 - __main__ - INFO - ✅ Saved 8939 records to bloodBath/bloodBank/raw/pump_901161470/2025-06-01_to_2025-07-01.csv with v2.0 header
2025-10-13 21:03:04,950 - __main__ - INFO - Processing chunk 6/9: 2025-07-01 to 2025-07-31
2025-10-13 21:03:04,950 - __main__ - INFO - Fetching data for pump 901161470: 2025-07-01 to 2025-07-31
2025-10-13 21:03:05,951 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:05,952 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 10 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 49 sec)
2025-10-13 21:03:05,952 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:09,978 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:09,978 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 14 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 45 sec)
2025-10-13 21:03:09,978 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:15,469 - tconnectsync.api.tandemsource - INFO - Read 3031418 bytes (est. 116593.0 events)
2025-10-13 21:03:19,523 - __main__ - INFO - Successfully fetched 8938 records for pump 901161470
2025-10-13 21:03:19,635 - __main__ - INFO - ✅ Saved 8938 records to bloodBath/bloodBank/raw/pump_901161470/2025-07-01_to_2025-07-31.csv with v2.0 header
2025-10-13 21:03:20,230 - __main__ - INFO - Processing chunk 7/9: 2025-07-31 to 2025-08-30
2025-10-13 21:03:20,231 - __main__ - INFO - Fetching data for pump 901161470: 2025-07-31 to 2025-08-30
2025-10-13 21:03:21,232 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:21,232 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 26 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 33 sec)
2025-10-13 21:03:21,232 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:26,459 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:26,459 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 31 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 28 sec)
2025-10-13 21:03:26,459 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:31,257 - tconnectsync.api.tandemsource - INFO - Read 3068780 bytes (est. 118030.0 events)
2025-10-13 21:03:35,330 - __main__ - INFO - Successfully fetched 8943 records for pump 901161470
2025-10-13 21:03:35,445 - __main__ - INFO - ✅ Saved 8943 records to bloodBath/bloodBank/raw/pump_901161470/2025-07-31_to_2025-08-30.csv with v2.0 header
2025-10-13 21:03:36,040 - __main__ - INFO - Processing chunk 8/9: 2025-08-30 to 2025-09-29
2025-10-13 21:03:36,041 - __main__ - INFO - Fetching data for pump 901161470: 2025-08-30 to 2025-09-29
2025-10-13 21:03:37,042 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:37,043 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 41 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 17 sec)
2025-10-13 21:03:37,043 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:41,813 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:41,813 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 46 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 13 sec)
2025-10-13 21:03:41,813 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:46,104 - tconnectsync.api.tandemsource - INFO - Read 3133520 bytes (est. 120520.0 events)
2025-10-13 21:03:50,164 - __main__ - INFO - Successfully fetched 8949 records for pump 901161470
2025-10-13 21:03:50,280 - __main__ - INFO - ✅ Saved 8949 records to bloodBath/bloodBank/raw/pump_901161470/2025-08-30_to_2025-09-29.csv with v2.0 header
2025-10-13 21:03:50,881 - __main__ - INFO - Processing chunk 9/9: 2025-09-29 to 2025-10-13
2025-10-13 21:03:50,881 - __main__ - INFO - Fetching data for pump 901161470: 2025-09-29 to 2025-10-13
2025-10-13 21:03:51,881 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:51,882 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 56 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (in 3 sec)
2025-10-13 21:03:51,882 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:54,095 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 21:03:54,095 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T03:33:55.211316+00:00 (29 min 58 sec ago), access token expiry 2025-10-14T04:03:55+00:00 (now)
2025-10-13 21:03:54,095 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 21:03:57,374 - tconnectsync.api.tandemsource - INFO - Read 1483872 bytes (est. 57072.0 events)
2025-10-13 21:03:59,305 - __main__ - INFO - Successfully fetched 4279 records for pump 901161470
2025-10-13 21:03:59,364 - __main__ - INFO - ✅ Saved 4279 records to bloodBath/bloodBank/raw/pump_901161470/2025-09-29_to_2025-10-13.csv with v2.0 header
2025-10-13 21:03:59,914 - __main__ - INFO - Sync completed for pump 901161470
2025-10-13 21:03:59,915 - __main__ - INFO - Total records processed: 75794
2025-10-13 21:03:59,915 - __main__ - INFO - Merging pump CSVs into combined format...
/home/bolt/projects/bb/bloodbank_download.py:1296: DtypeWarning: Columns (9) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(file_path)
2025-10-13 21:04:06,436 - __main__ - INFO - Loaded 7390000 records from bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_combined.csv
2025-10-13 21:04:08,947 - __main__ - INFO - Loaded 1722106 records from bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_881235.csv
2025-10-13 21:04:12,654 - __main__ - INFO - Loaded 2555014 records from bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_901161470.csv
2025-10-13 21:06:20,981 - __main__ - INFO - Merged 11667120 records from 3 pumps to bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_combined.csv
2025-10-13 21:06:21,945 - __main__ - INFO - Combined data summary:
                            timestamp  ... bolus_dose
                                  min  ...        sum
pump_serial                            ...           
881235      2021-01-01 08:00:00+00:00  ...        0.0
901161470   2024-01-01 08:00:00+00:00  ...        0.0
combined    2021-01-01 08:00:00+00:00  ...        0.0

[3 rows x 8 columns]

Sync completed: 1/1 pumps successful
  Pump 901161470: ✅ SUCCESS
