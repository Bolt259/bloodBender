nohup: ignoring input
/home/bolt/projects/bb/tconnectsync-bb/tconnectsync/__init__.py:6: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
2025-10-13 18:59:12,403 - __main__ - INFO - Initialized TandemHistoricalSyncClient
2025-10-13 18:59:12,403 - __main__ - INFO - Output directory: bloodBath/bloodBank/raw
2025-10-13 18:59:12,404 - __main__ - INFO - Chunk size: 30 days
2025-10-13 18:59:12,404 - __main__ - INFO - Starting sync for 1 pump(s)
2025-10-13 18:59:12,404 - __main__ - INFO - Starting sync for pump 901161470
2025-10-13 18:59:12,405 - __main__ - INFO - Generated 22 date chunks for pump 901161470
2025-10-13 18:59:12,406 - __main__ - INFO - Processing chunk 1/22: 2024-01-01 to 2024-01-31
2025-10-13 18:59:12,406 - __main__ - INFO - Connecting to Tandem API (US region)...
2025-10-13 18:59:12,406 - __main__ - INFO - API connection established
2025-10-13 18:59:12,406 - tconnectsync.api.tandemsource - INFO - Logging in to TandemSourceApi (US region)...
2025-10-13 18:59:12,407 - tconnectsync.api.tandemsource - INFO - Loaded cached credentials from /home/bolt/.config/tconnectsync/.creds_cache: saved at 2025-10-14T01:56:42.298614+00:00 (2 min 30 sec ago), access token expiry 2025-10-14T02:26:42+00:00 (in 27 min 29 sec)
2025-10-13 18:59:12,407 - tconnectsync.api.tandemsource - INFO - Successfully used cached credentials
2025-10-13 18:59:13,080 - __main__ - INFO - Fetching data for pump 901161470: 2024-01-01 to 2024-01-31
2025-10-13 18:59:14,651 - tconnectsync.api.tandemsource - INFO - Read 12454 bytes (est. 479.0 events)
2025-10-13 18:59:14,748 - __main__ - INFO - Successfully fetched 80554 records for pump 901161470
2025-10-13 18:59:15,804 - __main__ - INFO - ✅ Saved 80554 records to bloodBath/bloodBank/raw/pump_901161470/2024-01-01_to_2024-01-31.csv with v2.0 header
2025-10-13 18:59:17,194 - __main__ - INFO - Processing chunk 2/22: 2024-01-31 to 2024-03-01
2025-10-13 18:59:17,194 - __main__ - INFO - Fetching data for pump 901161470: 2024-01-31 to 2024-03-01
2025-10-13 18:59:18,729 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:18,791 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:19,731 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-01-31_to_2024-03-01.csv with v2.0 header
2025-10-13 18:59:21,922 - __main__ - INFO - Processing chunk 3/22: 2024-03-01 to 2024-03-31
2025-10-13 18:59:21,922 - __main__ - INFO - Fetching data for pump 901161470: 2024-03-01 to 2024-03-31
2025-10-13 18:59:23,999 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:24,056 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:25,040 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-03-01_to_2024-03-31.csv with v2.0 header
2025-10-13 18:59:26,462 - __main__ - INFO - Processing chunk 4/22: 2024-03-31 to 2024-04-30
2025-10-13 18:59:26,462 - __main__ - INFO - Fetching data for pump 901161470: 2024-03-31 to 2024-04-30
2025-10-13 18:59:28,237 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:28,282 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:29,070 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-03-31_to_2024-04-30.csv with v2.0 header
2025-10-13 18:59:30,397 - __main__ - INFO - Processing chunk 5/22: 2024-04-30 to 2024-05-30
2025-10-13 18:59:30,397 - __main__ - INFO - Fetching data for pump 901161470: 2024-04-30 to 2024-05-30
2025-10-13 18:59:31,951 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:31,998 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:32,886 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-04-30_to_2024-05-30.csv with v2.0 header
2025-10-13 18:59:34,242 - __main__ - INFO - Processing chunk 6/22: 2024-05-30 to 2024-06-29
2025-10-13 18:59:34,243 - __main__ - INFO - Fetching data for pump 901161470: 2024-05-30 to 2024-06-29
2025-10-13 18:59:36,020 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:36,061 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:36,857 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-05-30_to_2024-06-29.csv with v2.0 header
2025-10-13 18:59:38,156 - __main__ - INFO - Processing chunk 7/22: 2024-06-29 to 2024-07-29
2025-10-13 18:59:38,157 - __main__ - INFO - Fetching data for pump 901161470: 2024-06-29 to 2024-07-29
2025-10-13 18:59:39,778 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:39,821 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:40,609 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-06-29_to_2024-07-29.csv with v2.0 header
2025-10-13 18:59:41,903 - __main__ - INFO - Processing chunk 8/22: 2024-07-29 to 2024-08-28
2025-10-13 18:59:41,904 - __main__ - INFO - Fetching data for pump 901161470: 2024-07-29 to 2024-08-28
2025-10-13 18:59:43,550 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:43,592 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:44,362 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-07-29_to_2024-08-28.csv with v2.0 header
2025-10-13 18:59:45,649 - __main__ - INFO - Processing chunk 9/22: 2024-08-28 to 2024-09-27
2025-10-13 18:59:45,649 - __main__ - INFO - Fetching data for pump 901161470: 2024-08-28 to 2024-09-27
2025-10-13 18:59:47,579 - tconnectsync.api.tandemsource - INFO - Read 9854 bytes (est. 379.0 events)
2025-10-13 18:59:47,639 - __main__ - INFO - Successfully fetched 76913 records for pump 901161470
2025-10-13 18:59:48,426 - __main__ - INFO - ✅ Saved 76913 records to bloodBath/bloodBank/raw/pump_901161470/2024-08-28_to_2024-09-27.csv with v2.0 header
2025-10-13 18:59:49,703 - __main__ - INFO - Processing chunk 10/22: 2024-09-27 to 2024-10-27
2025-10-13 18:59:49,704 - __main__ - INFO - Fetching data for pump 901161470: 2024-09-27 to 2024-10-27
2025-10-13 18:59:59,398 - tconnectsync.api.tandemsource - INFO - Read 2103036 bytes (est. 80886.0 events)
2025-10-13 19:00:02,812 - __main__ - INFO - Successfully fetched 83043 records for pump 901161470
2025-10-13 19:00:03,765 - __main__ - INFO - ✅ Saved 83043 records to bloodBath/bloodBank/raw/pump_901161470/2024-09-27_to_2024-10-27.csv with v2.0 header
2025-10-13 19:00:05,130 - __main__ - INFO - Processing chunk 11/22: 2024-10-27 to 2024-11-26
2025-10-13 19:00:05,130 - __main__ - INFO - Fetching data for pump 901161470: 2024-10-27 to 2024-11-26
2025-10-13 19:00:18,108 - tconnectsync.api.tandemsource - INFO - Read 2954718 bytes (est. 113643.0 events)
2025-10-13 19:00:22,579 - __main__ - INFO - Successfully fetched 8957 records for pump 901161470
2025-10-13 19:00:22,690 - __main__ - INFO - ✅ Saved 8957 records to bloodBath/bloodBank/raw/pump_901161470/2024-10-27_to_2024-11-26.csv with v2.0 header
2025-10-13 19:00:23,284 - __main__ - INFO - Processing chunk 12/22: 2024-11-26 to 2024-12-26
2025-10-13 19:00:23,284 - __main__ - INFO - Fetching data for pump 901161470: 2024-11-26 to 2024-12-26
2025-10-13 19:00:32,355 - tconnectsync.api.tandemsource - INFO - Read 3086798 bytes (est. 118723.0 events)
2025-10-13 19:00:37,534 - __main__ - INFO - Successfully fetched 8945 records for pump 901161470
2025-10-13 19:00:37,675 - __main__ - INFO - ✅ Saved 8945 records to bloodBath/bloodBank/raw/pump_901161470/2024-11-26_to_2024-12-26.csv with v2.0 header
2025-10-13 19:00:38,284 - __main__ - INFO - Processing chunk 13/22: 2024-12-26 to 2025-01-25
2025-10-13 19:00:38,284 - __main__ - INFO - Fetching data for pump 901161470: 2024-12-26 to 2025-01-25
2025-10-13 19:00:48,210 - tconnectsync.api.tandemsource - INFO - Read 3082456 bytes (est. 118556.0 events)
2025-10-13 19:00:52,894 - __main__ - INFO - Successfully fetched 8953 records for pump 901161470
2025-10-13 19:00:53,005 - __main__ - INFO - ✅ Saved 8953 records to bloodBath/bloodBank/raw/pump_901161470/2024-12-26_to_2025-01-25.csv with v2.0 header
2025-10-13 19:00:53,597 - __main__ - INFO - Processing chunk 14/22: 2025-01-25 to 2025-02-24
2025-10-13 19:00:53,597 - __main__ - INFO - Fetching data for pump 901161470: 2025-01-25 to 2025-02-24
2025-10-13 19:01:02,736 - tconnectsync.api.tandemsource - INFO - Read 3198702 bytes (est. 123027.0 events)
2025-10-13 19:01:06,779 - __main__ - INFO - Successfully fetched 8932 records for pump 901161470
2025-10-13 19:01:06,888 - __main__ - INFO - ✅ Saved 8932 records to bloodBath/bloodBank/raw/pump_901161470/2025-01-25_to_2025-02-24.csv with v2.0 header
2025-10-13 19:01:07,480 - __main__ - INFO - Processing chunk 15/22: 2025-02-24 to 2025-03-26
2025-10-13 19:01:07,480 - __main__ - INFO - Fetching data for pump 901161470: 2025-02-24 to 2025-03-26
2025-10-13 19:01:16,046 - tconnectsync.api.tandemsource - INFO - Read 3184324 bytes (est. 122474.0 events)
2025-10-13 19:01:20,248 - __main__ - INFO - Successfully fetched 8935 records for pump 901161470
2025-10-13 19:01:20,358 - __main__ - INFO - ✅ Saved 8935 records to bloodBath/bloodBank/raw/pump_901161470/2025-02-24_to_2025-03-26.csv with v2.0 header
2025-10-13 19:01:20,951 - __main__ - INFO - Processing chunk 16/22: 2025-03-26 to 2025-04-25
2025-10-13 19:01:20,951 - __main__ - INFO - Fetching data for pump 901161470: 2025-03-26 to 2025-04-25
2025-10-13 19:01:29,857 - tconnectsync.api.tandemsource - INFO - Read 3183986 bytes (est. 122461.0 events)
2025-10-13 19:01:34,564 - __main__ - INFO - Successfully fetched 8942 records for pump 901161470
2025-10-13 19:01:34,674 - __main__ - INFO - ✅ Saved 8942 records to bloodBath/bloodBank/raw/pump_901161470/2025-03-26_to_2025-04-25.csv with v2.0 header
2025-10-13 19:01:35,268 - __main__ - INFO - Processing chunk 17/22: 2025-04-25 to 2025-05-25
2025-10-13 19:01:35,269 - __main__ - INFO - Fetching data for pump 901161470: 2025-04-25 to 2025-05-25
2025-10-13 19:01:43,538 - tconnectsync.api.tandemsource - INFO - Read 3121300 bytes (est. 120050.0 events)
2025-10-13 19:01:47,618 - __main__ - INFO - Successfully fetched 8947 records for pump 901161470
2025-10-13 19:01:47,731 - __main__ - INFO - ✅ Saved 8947 records to bloodBath/bloodBank/raw/pump_901161470/2025-04-25_to_2025-05-25.csv with v2.0 header
2025-10-13 19:01:48,344 - __main__ - INFO - Processing chunk 18/22: 2025-05-25 to 2025-06-24
2025-10-13 19:01:48,344 - __main__ - INFO - Fetching data for pump 901161470: 2025-05-25 to 2025-06-24
2025-10-13 19:01:58,308 - tconnectsync.api.tandemsource - INFO - Read 3075462 bytes (est. 118287.0 events)
2025-10-13 19:02:02,199 - __main__ - INFO - Successfully fetched 8930 records for pump 901161470
2025-10-13 19:02:02,306 - __main__ - INFO - ✅ Saved 8930 records to bloodBath/bloodBank/raw/pump_901161470/2025-05-25_to_2025-06-24.csv with v2.0 header
2025-10-13 19:02:02,899 - __main__ - INFO - Processing chunk 19/22: 2025-06-24 to 2025-07-24
2025-10-13 19:02:02,899 - __main__ - INFO - Fetching data for pump 901161470: 2025-06-24 to 2025-07-24
2025-10-13 19:02:17,528 - tconnectsync.api.tandemsource - INFO - Read 2973334 bytes (est. 114359.0 events)
2025-10-13 19:02:21,516 - __main__ - INFO - Successfully fetched 8939 records for pump 901161470
2025-10-13 19:02:21,626 - __main__ - INFO - ✅ Saved 8939 records to bloodBath/bloodBank/raw/pump_901161470/2025-06-24_to_2025-07-24.csv with v2.0 header
2025-10-13 19:02:22,226 - __main__ - INFO - Processing chunk 20/22: 2025-07-24 to 2025-08-23
2025-10-13 19:02:22,226 - __main__ - INFO - Fetching data for pump 901161470: 2025-07-24 to 2025-08-23
2025-10-13 19:02:55,809 - tconnectsync.api.tandemsource - INFO - Read 3099668 bytes (est. 119218.0 events)
2025-10-13 19:02:59,897 - __main__ - INFO - Successfully fetched 8932 records for pump 901161470
2025-10-13 19:03:00,004 - __main__ - INFO - ✅ Saved 8932 records to bloodBath/bloodBank/raw/pump_901161470/2025-07-24_to_2025-08-23.csv with v2.0 header
2025-10-13 19:03:00,596 - __main__ - INFO - Processing chunk 21/22: 2025-08-23 to 2025-09-22
2025-10-13 19:03:00,597 - __main__ - INFO - Fetching data for pump 901161470: 2025-08-23 to 2025-09-22
2025-10-13 19:03:10,411 - tconnectsync.api.tandemsource - INFO - Read 3084068 bytes (est. 118618.0 events)
2025-10-13 19:03:15,065 - __main__ - INFO - Successfully fetched 8938 records for pump 901161470
2025-10-13 19:03:15,172 - __main__ - INFO - ✅ Saved 8938 records to bloodBath/bloodBank/raw/pump_901161470/2025-08-23_to_2025-09-22.csv with v2.0 header
2025-10-13 19:03:15,764 - __main__ - INFO - Processing chunk 22/22: 2025-09-22 to 2025-10-12
2025-10-13 19:03:15,764 - __main__ - INFO - Fetching data for pump 901161470: 2025-09-22 to 2025-10-12
2025-10-13 19:03:22,860 - tconnectsync.api.tandemsource - INFO - Read 2140606 bytes (est. 82331.0 events)
2025-10-13 19:03:25,610 - __main__ - INFO - Successfully fetched 6061 records for pump 901161470
2025-10-13 19:03:25,682 - __main__ - INFO - ✅ Saved 6061 records to bloodBath/bloodBank/raw/pump_901161470/2025-09-22_to_2025-10-12.csv with v2.0 header
2025-10-13 19:03:26,246 - __main__ - INFO - Sync completed for pump 901161470
2025-10-13 19:03:26,246 - __main__ - INFO - Total records processed: 883312
2025-10-13 19:03:26,246 - __main__ - INFO - Merging pump CSVs into combined format...
2025-10-13 19:03:26,261 - __main__ - INFO - Loaded 8935 records from bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_combined.csv
2025-10-13 19:03:27,222 - __main__ - INFO - Loaded 700800 records from bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_881235.csv
2025-10-13 19:03:28,437 - __main__ - INFO - Loaded 883312 records from bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_901161470.csv
2025-10-13 19:03:46,297 - __main__ - INFO - Merged 1593047 records from 3 pumps to bloodBath/bloodBank/raw/data/lstm_ready/lstm_ready_combined.csv
2025-10-13 19:03:46,443 - __main__ - INFO - Combined data summary:
                            timestamp  ... bolus_dose
                                  min  ...        sum
pump_serial                            ...           
881235      2021-01-01 08:00:00+00:00  ...        0.0
901161470   2024-01-01 08:00:00+00:00  ...        0.0
combined    2024-01-01 07:55:00+00:00  ...        0.0

[3 rows x 8 columns]

Sync completed: 1/1 pumps successful
  Pump 901161470: ✅ SUCCESS
